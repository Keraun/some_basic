!function(e,i){"function"==typeof define&&define.amd?define(i):"object"==typeof exports?module.exports=i():e.catmenu=i()}(window,function(){"use strict";function e(e){this.options=e,this.init()}var i={};i.runScroll=function(e){if(!e.selector)throw"[runScroll] : have not found selector!";var i=$(e.selector[0]?e.selector[0]:e.selector);i.__scroll&&clearInterval(i.timer);var t=i.scrollLeft(),l=i.scrollTop(),s="undefined"!=typeof e.scrollLeft?parseInt(e.scrollLeft):t,n="undefined"!=typeof e.scrollTop?parseInt(e.scrollTop):l,a=s-t,r=n-l,o=0,c=parseInt((e.during||500)/10);i.timer=setInterval(function(){i.__scroll=!0,i.scrollLeft(a/c*o+t),i.scrollTop(r/c*o+l),o===c&&(e.callback&&e.callback(),clearInterval(i.timer),i.__scroll=!1),o++},10)};var t=function(i){return new e(i)},l={};return l.lisHtml=function(e){var i="<ul>";for(var t in e){var l="";for(var s in e[t])l+="data-"+s+"="+e[t][s]+" ";i+="<li "+l+"><span>"+t+"</span></li>"}return i+="</ul>"},l.isEnough=function(e,i){var t=$(i).clone(),l=t.find("li"),s=0;return $(e).append(t.css("visibility","hidden")),$.each(l,function(){s+=parseInt($(this).width()+1)}),s<t.width()?(t.remove(),!1):(t.remove(),s)},e.prototype.init=function(){this.createHTML(),this.bindEvents()},e.prototype.createHTML=function(){var e=this.options,i=$("<div>").addClass("plugin-catmenu").html('<div class="slide"><div class="wrap">'+l.lisHtml(e.data)+"</div></div>"),t=l.isEnough(e.selector,i);t?(i.append('<div class="more"><a href="#">展开更多</a></div>'),i.append('<div class="list">'+l.lisHtml(e.data)+"</div>"),i.find(".slide").append('<div class="tips">'+(e.tips||"跳转楼层")+"</div>"),i.find(".slide ul").css("width",t),i.find(".slide li").eq(parseInt(e.active)||0).addClass("active"),i.find(".list li").eq(parseInt(e.active)||0).addClass("active"),$(e.selector).append(i)):(i.find("ul").addClass("flex"),i.find(".slide li").eq(parseInt(e.active)||0).addClass("active"),$(e.selector).append(i)),this.catmenu=i},e.prototype.bindEvents=function(){var e=this.options,t=this.catmenu,l=t.find(".more");if(l.length>0){l.on("click",function(){return t.toggleClass("active"),!1});var s=t.find(".slide li"),n=t.find(".list li");t.find(".slide li,.list li").on("click",function(){var l=$(this),a=l.index(),r=t.width(),o=parseInt(s.eq(a).offset().left+t.find(".slide .wrap").scrollLeft()-r/2+l.width()/2);s.removeClass("active").eq(a).addClass("active"),n.removeClass("active").eq(a).addClass("active"),t.removeClass("active");var c=!1;l.parents(".list").length>0&&(c=!0),e.handler.call(this,c,function(){i.runScroll({selector:t.find(".wrap"),scrollLeft:o,during:300})})})}else t.find(".slide li").on("click",function(){$(this).addClass("active").siblings().removeClass("active"),e.handler.call(this)})},t});